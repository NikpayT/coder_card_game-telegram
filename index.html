<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–≥—Ä–∞: –°–±–æ—Ä—â–∏–∫ –ö–æ–¥–∞ SQL</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f0f0;
            color: #333;
            text-align: center;
        }
        .game-container {
            max-width: 600px;
            margin: 20px auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .header-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            font-size: 1.1em;
            color: #555;
        }
        .message {
            margin-bottom: 15px;
            font-size: 1.1em;
            color: #333;
        }
        .buttons-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
        }
        button {
            padding: 10px 15px;
            font-size: 1em;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            background-color: #007bff;
            color: white;
            transition: background-color 0.2s;
            flex-grow: 1; /* –ß—Ç–æ–±—ã –∫–Ω–æ–ø–∫–∏ –∑–∞–Ω–∏–º–∞–ª–∏ –±–æ–ª—å—à–µ –º–µ—Å—Ç–∞ */
            min-width: 120px; /* –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –¥–ª—è –∫–Ω–æ–ø–æ–∫ */
        }
        button:hover {
            background-color: #0056b3;
        }
        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        .collection-item, .shop-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            margin-bottom: 10px;
            background-color: #e2e6ea;
            border-radius: 4px;
            text-align: left;
            position: relative;
            cursor: pointer;
            flex-wrap: wrap; /* –î–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –æ–ø–∏—Å–∞–Ω–∏—è */
        }
        .collection-item-main, .shop-item-main {
            flex-grow: 1;
            padding-right: 10px; /* –û—Ç—Å—Ç—É–ø –æ—Ç –∫–Ω–æ–ø–∫–∏ */
        }
        .collection-item-description, .shop-item-description {
            font-size: 0.9em;
            color: #666;
            margin-top: 5px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            width: 100%; /* –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–Ω–∏–º–∞–µ—Ç –≤—Å—é —à–∏—Ä–∏–Ω—É */
        }
        .collection-item-description.show, .shop-item-description.show {
            max-height: 100px;
        }
        .item-action-button {
            padding: 5px 10px;
            font-size: 0.8em;
            background-color: #28a745; /* –ó–µ–ª–µ–Ω–∞—è –¥–ª—è –ø–æ–∫—É–ø–∫–∏/–ø—Ä–æ–¥–∞–∂–∏ */
            margin-left: 10px;
            flex-shrink: 0; /* –ù–µ —Å–∂–∏–º–∞—Ç—å –∫–Ω–æ–ø–∫—É */
        }
        .item-action-button.sell {
            background-color: #dc3545; /* –ö—Ä–∞—Å–Ω–∞—è –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏ */
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="header-info">
            <span id="experienceDisplay">–û–ø—ã—Ç: 0 üåü</span>
            <span id="gameMessage" class="message">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∏–≥—Ä—É "–°–±–æ—Ä—â–∏–∫ SQL-—Ñ—É–Ω–∫—Ü–∏–π"! üöÄ</span>
        </div>

        <div class="buttons-container">
            <button id="collectButton">–ù–∞–π—Ç–∏ SQL-—Ñ—É–Ω–∫—Ü–∏—é üîç</button>
            <button id="viewCollectionButton">–ú–æ—è –∫–æ–ª–ª–µ–∫—Ü–∏—è SQL üéí</button>
            <button id="createButton">–°–æ–∑–¥–∞—Ç—å SQL-–∑–∞–ø—Ä–æ—Å üí°</button>
            <button id="shopButton">–ú–∞–≥–∞–∑–∏–Ω üí∞</button> </div>

        <div id="collectionDisplay" style="display: none; margin-top: 20px;">
            <h3>–ú–æ—è –∫–æ–ª–ª–µ–∫—Ü–∏—è SQL:</h3>
            <div id="collectionList">
                <p>–ü–æ–∫–∞ –Ω–∏—á–µ–≥–æ –Ω–µ—Ç...</p>
            </div>
            <button id="backFromCollection">–ù–∞–∑–∞–¥</button>
        </div>

        <div id="createPanel" style="display: none; margin-top: 20px;">
            <h3>–°–æ–∑–¥–∞–Ω–∏–µ SQL-–∑–∞–ø—Ä–æ—Å–∞:</h3>
            <div id="availableParts">
                <p>–°–Ω–∞—á–∞–ª–∞ —Å–æ–±–µ—Ä–∏—Ç–µ SQL-—Ñ—É–Ω–∫—Ü–∏–∏!</p>
            </div>
            <button id="backFromCreate">–ù–∞–∑–∞–¥</button>
        </div>

        <div id="shopPanel" style="display: none; margin-top: 20px;">
            <h3>–ú–∞–≥–∞–∑–∏–Ω SQL-—Ñ—É–Ω–∫—Ü–∏–π:</h3>
            <div class="buttons-container">
                <button id="buyRandomButton">–ö—É–ø–∏—Ç—å —Å–ª—É—á–∞–π–Ω—É—é (1 üåü)</button>
                <button id="sellPartsButton">–ü—Ä–æ–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é (1 üåü)</button>
            </div>

            <div id="sellList" style="display: none; margin-top: 15px;">
                <h4>–í—ã–±–µ—Ä–∏—Ç–µ —á—Ç–æ –ø—Ä–æ–¥–∞—Ç—å:</h4>
                <div id="sellableItemsList">
                    <p>–ù–µ—Ç —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏.</p>
                </div>
            </div>

            <button id="backFromShop" style="margin-top: 20px;">–ù–∞–∑–∞–¥</button>
        </div>

    </div> <div style="font-size: 0.8em; color: #888; margin-top: 20px;">
        –í–µ—Ä—Å–∏—è: <span id="gameVersion">0.2.0</span> </div>

    <script src="game_data.js"></script>

    <script>
        let gameData = {
            message: "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∏–≥—Ä—É!",
            collection: [],
            experience: 0, // –ù–û–í–û–ï: –û–ø—ã—Ç/–º–æ–Ω–µ—Ç—ã –∏–≥—Ä–æ–∫–∞
            currentView: 'main' // 'main', 'collection', 'create', 'shop', 'sell_mode'
        };

        // DOM-—ç–ª–µ–º–µ–Ω—Ç—ã
        const gameMessageElement = document.getElementById('gameMessage');
        const experienceDisplay = document.getElementById('experienceDisplay'); // –ù–û–í–û–ï
        const buttonsContainer = document.querySelector('.buttons-container');
        const collectButton = document.getElementById('collectButton');
        const viewCollectionButton = document.getElementById('viewCollectionButton');
        const createButton = document.getElementById('createButton');
        const shopButton = document.getElementById('shopButton'); // –ù–û–í–û–ï

        const collectionDisplay = document.getElementById('collectionDisplay');
        const collectionList = document.getElementById('collectionList');
        const backFromCollectionButton = document.getElementById('backFromCollection');

        const createPanel = document.getElementById('createPanel');
        const availablePartsDiv = document.getElementById('availableParts');
        const backFromCreateButton = document.getElementById('backFromCreate');

        // –≠–ª–µ–º–µ–Ω—Ç—ã –º–∞–≥–∞–∑–∏–Ω–∞ (–ù–û–í–´–ï)
        const shopPanel = document.getElementById('shopPanel');
        const buyRandomButton = document.getElementById('buyRandomButton');
        const sellPartsButton = document.getElementById('sellPartsButton');
        const sellList = document.getElementById('sellList');
        const sellableItemsList = document.getElementById('sellableItemsList');
        const backFromShopButton = document.getElementById('backFromShop');


        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App SDK
        if (window.Telegram && window.Telegram.WebApp) {
            Telegram.WebApp.ready();
            Telegram.WebApp.expand();
            console.log('Telegram WebApp initialized.');
        } else {
            console.warn('Telegram WebApp script not loaded or not in Telegram environment.');
        }

        // --- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ UI –∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏ ---
        function updateUI() {
            gameMessageElement.textContent = gameData.message;
            experienceDisplay.textContent = `–û–ø—ã—Ç: ${gameData.experience} üåü`; // –û–±–Ω–æ–≤–ª—è–µ–º –æ–ø—ã—Ç

            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –ø–∞–Ω–µ–ª–∏
            buttonsContainer.style.display = 'none';
            collectionDisplay.style.display = 'none';
            createPanel.style.display = 'none';
            shopPanel.style.display = 'none';
            sellList.style.display = 'none'; // –°–∫—Ä—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–¥–∞–∂–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é –ø–∞–Ω–µ–ª—å –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ –≤–∏–¥–∞
            if (gameData.currentView === 'main') {
                buttonsContainer.style.display = 'flex';
            } else if (gameData.currentView === 'collection') {
                collectionDisplay.style.display = 'block';
                renderCollection();
            } else if (gameData.currentView === 'create') {
                createPanel.style.display = 'block';
                renderCreatePanel();
            } else if (gameData.currentView === 'shop') {
                shopPanel.style.display = 'block';
                // –ü—Ä–∏ –≤—Ö–æ–¥–µ –≤ –º–∞–≥–∞–∑–∏–Ω, —Å–∫—Ä—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–¥–∞–∂–∏, –µ—Å–ª–∏ –æ–Ω –±—ã–ª –æ—Ç–∫—Ä—ã—Ç
                sellList.style.display = 'none';
            } else if (gameData.currentView === 'sell_mode') { // –†–µ–∂–∏–º –ø—Ä–æ–¥–∞–∂–∏ –≤–Ω—É—Ç—Ä–∏ –º–∞–≥–∞–∑–∏–Ω–∞
                shopPanel.style.display = 'block';
                sellList.style.display = 'block';
                renderSellableItems();
            }

            // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–æ–π –ø–æ–∫—É–ø–∫–∏
            buyRandomButton.disabled = gameData.experience < 1;
        }

        function renderCollection() {
            if (gameData.collection.length === 0) {
                collectionList.innerHTML = '<p>–ü–æ–∫–∞ –Ω–∏—á–µ–≥–æ –Ω–µ—Ç...</p>';
            } else {
                collectionList.innerHTML = '';
                gameData.collection.forEach(item => {
                    const div = document.createElement('div');
                    div.className = 'collection-item';
                    div.innerHTML = `
                        <div class="collection-item-main">
                            ${item.emoji} ${item.name}
                            <div class="collection-item-description" id="desc-${item.id}">
                                ${item.description}
                            </div>
                        </div>
                    `;
                    div.onclick = () => { // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –¥–ª—è –ø–æ–∫–∞–∑–∞/—Å–∫—Ä—ã—Ç–∏—è –æ–ø–∏—Å–∞–Ω–∏—è
                        const descElement = document.getElementById(`desc-${item.id}`);
                        if (descElement) {
                            descElement.classList.toggle('show');
                        }
                    };
                    collectionList.appendChild(div);
                });
            }
        }

        function renderCreatePanel() {
            if (gameData.collection.length === 0) {
                availablePartsDiv.innerHTML = '<p>–°–Ω–∞—á–∞–ª–∞ —Å–æ–±–µ—Ä–∏—Ç–µ SQL-—Ñ—É–Ω–∫—Ü–∏–∏, —á—Ç–æ–±—ã —á—Ç–æ-—Ç–æ —Å–æ–∑–¥–∞—Ç—å!</p>';
            } else {
                availablePartsDiv.innerHTML = '<p>–í—ã–±–µ—Ä–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ –≤–∞—à–µ–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –¥–ª—è "—Å–±–æ—Ä–∫–∏":</p>';
                availablePartsDiv.innerHTML = ''; // –û—á–∏—â–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –Ω–æ–≤—ã—Ö –∫–Ω–æ–ø–æ–∫

                gameData.collection.forEach(item => {
                    const button = document.createElement('button');
                    button.textContent = `${item.emoji} ${item.name}`;
                    button.onclick = () => selectPartToCreate(item.id);
                    availablePartsDiv.appendChild(button);
                });
                if (gameData.collection.length > 0) {
                     const createFinalButton = document.createElement('button');
                     createFinalButton.textContent = '‚ö°Ô∏è –°–æ–±—Ä–∞—Ç—å SQL-–∑–∞–ø—Ä–æ—Å (–ø–æ–∫–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)';
                     createFinalButton.style.marginTop = '10px';
                     createFinalButton.onclick = () => {
                         gameData.message = '–í—ã –ø—ã—Ç–∞–ª–∏—Å—å —Å–æ–±—Ä–∞—Ç—å SQL-–∑–∞–ø—Ä–æ—Å! üõ†Ô∏è (—Ñ—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)';
                         updateUI();
                     };
                     availablePartsDiv.appendChild(createFinalButton);
                }
            }
        }

        function renderSellableItems() {
            if (gameData.collection.length === 0) {
                sellableItemsList.innerHTML = '<p>–ù–µ—Ç —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏.</p>';
            } else {
                sellableItemsList.innerHTML = '';
                gameData.collection.forEach(item => {
                    const div = document.createElement('div');
                    div.className = 'shop-item'; // –ò—Å–ø–æ–ª—å–∑—É–µ–º shop-item –¥–ª—è —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏
                    div.innerHTML = `
                        <div class="shop-item-main">
                            ${item.emoji} ${item.name}
                            <div class="shop-item-description" id="shop-desc-${item.id}">
                                ${item.description}
                            </div>
                        </div>
                        <button class="item-action-button sell" data-item-id="${item.id}">–ü—Ä–æ–¥–∞—Ç—å (1 üåü)</button>
                    `;
                    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ü—Ä–æ–¥–∞—Ç—å"
                    div.querySelector('.item-action-button').onclick = (event) => {
                        event.stopPropagation(); // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ –∫–ª–∏–∫–∞ –Ω–∞ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–º div
                        sellPart(item.id);
                    };
                    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø–æ–∫–∞–∑–∞/—Å–∫—Ä—ã—Ç–∏—è –æ–ø–∏—Å–∞–Ω–∏—è –ø–æ –∫–ª–∏–∫—É –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç
                    div.onclick = () => {
                        const descElement = document.getElementById(`shop-desc-${item.id}`);
                        if (descElement) {
                            descElement.classList.toggle('show');
                        }
                    };
                    sellableItemsList.appendChild(div);
                });
            }
        }

        // --- –õ–æ–≥–∏–∫–∞ –∏–≥—Ä—ã ---
        function selectPartToCreate(partId) {
            const selectedPart = gameData.collection.find(p => p.id === partId);
            if (selectedPart) {
                gameData.message = `–í—ã –≤—ã–±—Ä–∞–ª–∏ "${selectedPart.name}" –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è! ü§î (–Ω—É–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–ª—è "—Å–±–æ—Ä–∫–∏")`;
                updateUI();
            }
        }

        // --- –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ –ø–æ–∫—É–ø–∫–∏/–ø—Ä–æ–¥–∞–∂–∏ ---
        function buyRandomPart() {
            if (gameData.experience < 1) {
                gameData.message = '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ–ø—ã—Ç–∞ –¥–ª—è –ø–æ–∫—É–ø–∫–∏! üö´';
                updateUI();
                return;
            }

            // –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ —á–∞—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã—Ö –ù–ï–¢ –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –∏–≥—Ä–æ–∫–∞
            const missingParts = ALL_CODE_PARTS.filter(part => !gameData.collection.some(item => item.id === part.id));

            if (missingParts.length === 0) {
                gameData.message = '–í—ã —Å–æ–±—Ä–∞–ª–∏ –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ SQL-—Ñ—É–Ω–∫—Ü–∏–∏! üéâ';
                updateUI();
                return;
            }

            const randomIndex = Math.floor(Math.random() * missingParts.length);
            const boughtPart = missingParts[randomIndex];

            gameData.collection.push({...boughtPart});
            gameData.experience -= 1; // –¢—Ä–∞—Ç–∏–º 1 –æ–ø—ã—Ç
            gameData.message = `–í—ã –∫—É–ø–∏–ª–∏ –Ω–æ–≤—É—é SQL-—Ñ—É–Ω–∫—Ü–∏—é! üéâ ${boughtPart.emoji} ${boughtPart.name} (-1 üåü)`;
            updateUI();
        }

        function sellPart(partId) {
            const indexToSell = gameData.collection.findIndex(item => item.id === partId);

            if (indexToSell !== -1) {
                const soldPart = gameData.collection.splice(indexToSell, 1)[0]; // –£–¥–∞–ª—è–µ–º –∏ –ø–æ–ª—É—á–∞–µ–º –ø—Ä–æ–¥–∞–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
                gameData.experience += 1; // –ü–æ–ª—É—á–∞–µ–º 1 –æ–ø—ã—Ç
                gameData.message = `–í—ã –ø—Ä–æ–¥–∞–ª–∏ ${soldPart.emoji} ${soldPart.name}! (+1 üåü)`;
                updateUI();
            } else {
                gameData.message = '–≠—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ—Ç –≤ –≤–∞—à–µ–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏!';
                updateUI();
            }
        }

        // --- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –∫–Ω–æ–ø–æ–∫ ---
        collectButton.addEventListener('click', () => {
            const randomIndex = Math.floor(Math.random() * ALL_CODE_PARTS.length);
            const foundPart = ALL_CODE_PARTS[randomIndex];

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ —Ç–∞–∫–∞—è —á–∞—Å—Ç—å –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
            if (!gameData.collection.some(item => item.id === foundPart.id)) {
                gameData.collection.push({...foundPart});
                gameData.experience += 1; // –î–∞–µ–º –æ–ø—ã—Ç –∑–∞ –Ω–∞—Ö–æ–¥–∫—É
                gameData.message = `–í—ã –Ω–∞—à–ª–∏ –Ω–æ–≤—É—é SQL-—Ñ—É–Ω–∫—Ü–∏—é! üéâ ${foundPart.emoji} ${foundPart.name} (+1 üåü)`;
            } else {
                gameData.message = `–í—ã –Ω–∞—à–ª–∏ ${foundPart.emoji} ${foundPart.name}, –Ω–æ –æ–Ω–∞ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å! –ü–æ–∏—â–∏—Ç–µ —á—Ç–æ-—Ç–æ –¥—Ä—É–≥–æ–µ... üòÖ`;
            }
            updateUI();
        });

        viewCollectionButton.addEventListener('click', () => {
            gameData.currentView = 'collection';
            gameData.message = '–í–∞—à–∞ –∫–æ–ª–ª–µ–∫—Ü–∏—è SQL-—Ñ—É–Ω–∫—Ü–∏–π:';
            updateUI();
        });

        createButton.addEventListener('click', () => {
            gameData.currentView = 'create';
            gameData.message = '–ß—Ç–æ –≤—ã —Ö–æ—Ç–∏—Ç–µ —Å–æ–∑–¥–∞—Ç—å?';
            updateUI();
        });

        shopButton.addEventListener('click', () => { // –ù–û–í–´–ô –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –º–∞–≥–∞–∑–∏–Ω–∞
            gameData.currentView = 'shop';
            gameData.message = '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –º–∞–≥–∞–∑–∏–Ω!';
            updateUI();
        });

        buyRandomButton.addEventListener('click', buyRandomPart); // –ù–û–í–´–ô –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø–æ–∫—É–ø–∫–∏

        sellPartsButton.addEventListener('click', () => { // –ù–û–í–´–ô –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏
            gameData.currentView = 'sell_mode';
            gameData.message = '–í—ã–±–µ—Ä–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏:';
            updateUI();
        });

        // –ö–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥"
        backFromCollectionButton.addEventListener('click', () => {
            gameData.currentView = 'main';
            gameData.message = '–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ —Å–æ–±–∏—Ä–∞—Ç—å –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å!';
            updateUI();
        });

        backFromCreateButton.addEventListener('click', () => {
            gameData.currentView = 'main';
            gameData.message = '–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ —Å–æ–±–∏—Ä–∞—Ç—å –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å!';
            updateUI();
        });

        backFromShopButton.addEventListener('click', () => { // –ù–û–í–´–ô –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è "–ù–∞–∑–∞–¥ –∏–∑ –º–∞–≥–∞–∑–∏–Ω–∞"
            gameData.currentView = 'main';
            gameData.message = '–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è!';
            updateUI();
        });


        // --- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–ó–∞–≥—Ä—É–∑–∫–∞ –∏–≥—Ä—ã ---
        function saveGameData() {
            localStorage.setItem('coderGameData', JSON.stringify(gameData));
            console.log('Game data saved!');
        }

        function loadGameData() {
            const savedData = localStorage.getItem('coderGameData');
            if (savedData) {
                const loadedGameData = JSON.parse(savedData);
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –æ–ø—ã—Ç
                gameData.experience = loadedGameData.experience || 0;

                // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–ª–ª–µ–∫—Ü–∏—é, —É–±–µ–¥–∏–≤—à–∏—Å—å, —á—Ç–æ –≤—Å–µ –ø–æ–ª—è –∏–∑ ALL_CODE_PARTS –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç
                loadedGameData.collection = loadedGameData.collection.map(item => {
                    const fullItem = ALL_CODE_PARTS.find(part => part.id === item.id);
                    return fullItem ? {...fullItem} : item; // –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ, –±–µ—Ä–µ–º –ø–æ–ª–Ω—É—é –≤–µ—Ä—Å–∏—é –∏–∑ ALL_CODE_PARTS
                });
                gameData.collection = loadedGameData.collection;
                // gameData.message –∏ currentView –±—É–¥—É—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤ updateUI()
            }
        }

        // --- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ ---
        loadGameData(); // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
        updateUI();     // –û–±–Ω–æ–≤–ª—è–µ–º UI —Å–æ–≥–ª–∞—Å–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º –¥–∞–Ω–Ω—ã–º
        // –î–æ–±–∞–≤–ª—è–µ–º –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
        if (gameData.message === "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∏–≥—Ä—É!") { // –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –±—ã–ª–æ –∏–∑–º–µ–Ω–µ–Ω–æ –∑–∞–≥—Ä—É–∑–∫–æ–π
             gameMessageElement.textContent = `–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ! –£ –≤–∞—Å ${gameData.experience} üåü`;
        }


        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
        setInterval(saveGameData, 5000);
    </script>
</body>
</html>
