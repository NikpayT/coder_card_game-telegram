<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–≥—Ä–∞: –°–±–æ—Ä—â–∏–∫ –ö–æ–¥–∞</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f0f0;
            color: #333;
            text-align: center;
        }
        .game-container {
            max-width: 600px;
            margin: 20px auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .message {
            margin-bottom: 15px;
            font-size: 1.1em;
        }
        .buttons-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
        }
        button {
            padding: 10px 15px;
            font-size: 1em;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            background-color: #007bff;
            color: white;
            transition: background-color 0.2s;
        }
        button:hover {
            background-color: #0056b3;
        }
        .collection-item {
            display: block;
            padding: 8px;
            margin-bottom: 5px;
            background-color: #e2e6ea;
            border-radius: 4px;
            text-align: left;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="message" id="gameMessage">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∏–≥—Ä—É "–°–±–æ—Ä—â–∏–∫ –ö–æ–¥–∞"! üöÄ –°–æ–±–µ—Ä–∏—Ç–µ —Å–≤–æ—é –ø–µ—Ä–≤—É—é —á–∞—Å—Ç—å!</div>
        <div class="buttons-container">
            <button id="collectButton">–ù–∞–π—Ç–∏ —á–∞—Å—Ç—å –∫–æ–¥–∞ üîç</button>
            <button id="viewCollectionButton">–ú–æ—è –∫–æ–ª–ª–µ–∫—Ü–∏—è üéí</button>
            <button id="createButton">–°–æ–∑–¥–∞—Ç—å –∫–æ–¥ üí°</button>
        </div>

        <div id="collectionDisplay" style="display: none; margin-top: 20px;">
            <h3>–ú–æ—è –∫–æ–ª–ª–µ–∫—Ü–∏—è:</h3>
            <div id="collectionList">
                <p>–ü–æ–∫–∞ –Ω–∏—á–µ–≥–æ –Ω–µ—Ç...</p>
            </div>
            <button id="backFromCollection">–ù–∞–∑–∞–¥</button>
        </div>

        <div id="createPanel" style="display: none; margin-top: 20px;">
            <h3>–°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–¥–∞:</h3>
            <div id="availableParts">
                <p>–°–Ω–∞—á–∞–ª–∞ —Å–æ–±–µ—Ä–∏—Ç–µ —á–∞—Å—Ç–∏!</p>
            </div>
            <button id="backFromCreate">–ù–∞–∑–∞–¥</button>
        </div>
    </div>

    <script>
        let gameData = {
            message: "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∏–≥—Ä—É!",
            collection: [],
            availableCodeParts: [ // –ü—Ä–∏–º–µ—Ä—ã —á–∞—Å—Ç–µ–π –∫–æ–¥–∞
                { id: 'html_tag', name: 'HTML-—Ç–µ–≥ <body>', emoji: 'üìÑ' },
                { id: 'css_rule', name: 'CSS-–ø—Ä–∞–≤–∏–ª–æ {color:blue;}', emoji: 'üé®' },
                { id: 'js_func', name: 'JavaScript —Ñ—É–Ω–∫—Ü–∏—è alert()', emoji: 'üíª' },
                { id: 'python_print', name: 'Python print("Hello")', emoji: 'üêç' },
                { id: 'sql_select', name: 'SQL SELECT * FROM', emoji: 'üóÉÔ∏è' }
            ],
            // –î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è (–æ—Ç–∫—Ä—ã—Ç–æ –ª–∏ –æ–∫–Ω–æ –∫–æ–ª–ª–µ–∫—Ü–∏–∏/—Å–æ–∑–¥–∞–Ω–∏—è)
            currentView: 'main' // 'main', 'collection', 'create'
        };

        const gameMessageElement = document.getElementById('gameMessage');
        const buttonsContainer = document.querySelector('.buttons-container');
        const collectButton = document.getElementById('collectButton');
        const viewCollectionButton = document.getElementById('viewCollectionButton');
        const createButton = document.getElementById('createButton');
        const collectionDisplay = document.getElementById('collectionDisplay');
        const collectionList = document.getElementById('collectionList');
        const backFromCollectionButton = document.getElementById('backFromCollection');
        const createPanel = document.getElementById('createPanel');
        const availablePartsDiv = document.getElementById('availableParts');
        const backFromCreateButton = document.getElementById('backFromCreate');

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App SDK (–û–ß–ï–ù–¨ –í–ê–ñ–ù–û –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤–Ω—É—Ç—Ä–∏ –¢–ì)
        // –≠—Ç–æ —Å—Ç—Ä–æ–∫–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç HTML-—Å—Ç—Ä–∞–Ω–∏—Ü–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å Telegram
        if (window.Telegram && window.Telegram.WebApp) {
            Telegram.WebApp.ready();
            Telegram.WebApp.expand(); // –†–∞—Å—à–∏—Ä—è–µ–º –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –≤—Å—é –≤—ã—Å–æ—Ç—É
            console.log('Telegram WebApp initialized.');
            // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É –∑–∞–∫—Ä—ã—Ç–∏—è, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
            // Telegram.WebApp.setHeaderColor('#36802d'); // –¶–≤–µ—Ç —Ö–µ–¥–µ—Ä–∞
            // Telegram.WebApp.setBackgroundColor('#204c1a'); // –¶–≤–µ—Ç —Ñ–æ–Ω–∞
        } else {
            console.warn('Telegram WebApp script not loaded or not in Telegram environment.');
        }


        function updateUI() {
            gameMessageElement.textContent = gameData.message;

            // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –ø–∞–Ω–µ–ª–µ–π
            if (gameData.currentView === 'main') {
                buttonsContainer.style.display = 'flex';
                collectionDisplay.style.display = 'none';
                createPanel.style.display = 'none';
            } else if (gameData.currentView === 'collection') {
                buttonsContainer.style.display = 'none';
                collectionDisplay.style.display = 'block';
                createPanel.style.display = 'none';
                renderCollection();
            } else if (gameData.currentView === 'create') {
                buttonsContainer.style.display = 'none';
                collectionDisplay.style.display = 'none';
                createPanel.style.display = 'block';
                renderCreatePanel();
            }
        }

        function renderCollection() {
            if (gameData.collection.length === 0) {
                collectionList.innerHTML = '<p>–ü–æ–∫–∞ –Ω–∏—á–µ–≥–æ –Ω–µ—Ç...</p>';
            } else {
                collectionList.innerHTML = '';
                gameData.collection.forEach(item => {
                    const div = document.createElement('div');
                    div.className = 'collection-item';
                    div.textContent = `${item.emoji} ${item.name}`;
                    collectionList.appendChild(div);
                });
            }
        }

        function renderCreatePanel() {
            if (gameData.collection.length === 0) {
                availablePartsDiv.innerHTML = '<p>–°–Ω–∞—á–∞–ª–∞ —Å–æ–±–µ—Ä–∏—Ç–µ —á–∞—Å—Ç–∏ –∫–æ–¥–∞, —á—Ç–æ–±—ã —á—Ç–æ-—Ç–æ —Å–æ–∑–¥–∞—Ç—å!</p>';
            } else {
                availablePartsDiv.innerHTML = '<p>–í—ã–±–µ—Ä–∏—Ç–µ —á–∞—Å—Ç–∏ –∏–∑ –≤–∞—à–µ–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –¥–ª—è "—Å–±–æ—Ä–∫–∏":</p>';
                gameData.collection.forEach(item => {
                    const button = document.createElement('button');
                    button.textContent = `${item.emoji} ${item.name}`;
                    button.onclick = () => selectPartToCreate(item.id);
                    availablePartsDiv.appendChild(button);
                });
                // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–æ–∑–¥–∞–Ω–∏—è, –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω—ã —á–∞—Å—Ç–∏
                if (gameData.collection.length > 0) {
                     const createFinalButton = document.createElement('button');
                     createFinalButton.textContent = '‚ö°Ô∏è –°–æ–±—Ä–∞—Ç—å –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ (–ø–æ–∫–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)';
                     createFinalButton.style.marginTop = '10px';
                     createFinalButton.onclick = () => {
                         gameData.message = '–í—ã –ø—ã—Ç–∞–ª–∏—Å—å —á—Ç–æ-—Ç–æ —Å–æ–±—Ä–∞—Ç—å! üõ†Ô∏è (—Ñ—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)';
                         updateUI();
                     };
                     availablePartsDiv.appendChild(createFinalButton);
                }
            }
        }

        function selectPartToCreate(partId) {
            // –í —ç—Ç–æ–π –ø—Ä–æ—Å—Ç–æ–π –≤–µ—Ä—Å–∏–∏ –ø–æ–∫–∞ –ø—Ä–æ—Å—Ç–æ —É–≤–µ–¥–æ–º–ª—è–µ–º
            const selectedPart = gameData.collection.find(p => p.id === partId);
            if (selectedPart) {
                gameData.message = `–í—ã –≤—ã–±—Ä–∞–ª–∏ "${selectedPart.name}" –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è! ü§î (–Ω—É–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–ª—è "—Å–±–æ—Ä–∫–∏")`;
                updateUI();
            }
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –∫–Ω–æ–ø–æ–∫
        collectButton.addEventListener('click', () => {
            const randomIndex = Math.floor(Math.random() * gameData.availableCodeParts.length);
            const foundPart = gameData.availableCodeParts[randomIndex];

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ —Ç–∞–∫–∞—è —á–∞—Å—Ç—å –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
            if (!gameData.collection.some(item => item.id === foundPart.id)) {
                gameData.collection.push(foundPart);
                gameData.message = `–í—ã –Ω–∞—à–ª–∏ –Ω–æ–≤—É—é —á–∞—Å—Ç—å! üéâ ${foundPart.emoji} ${foundPart.name}`;
            } else {
                gameData.message = `–í—ã –Ω–∞—à–ª–∏ ${foundPart.emoji} ${foundPart.name}, –Ω–æ –æ–Ω–∞ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å! –ü–æ–∏—â–∏—Ç–µ —á—Ç–æ-—Ç–æ –¥—Ä—É–≥–æ–µ... üòÖ`;
            }
            updateUI();
        });

        viewCollectionButton.addEventListener('click', () => {
            gameData.currentView = 'collection';
            gameData.message = '–í–∞—à–∞ –∫–æ–ª–ª–µ–∫—Ü–∏—è —á–∞—Å—Ç–µ–π –∫–æ–¥–∞:';
            updateUI();
        });

        backFromCollectionButton.addEventListener('click', () => {
            gameData.currentView = 'main';
            gameData.message = '–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ —Å–æ–±–∏—Ä–∞—Ç—å –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å!';
            updateUI();
        });

        createButton.addEventListener('click', () => {
            gameData.currentView = 'create';
            gameData.message = '–ß—Ç–æ –≤—ã —Ö–æ—Ç–∏—Ç–µ —Å–æ–∑–¥–∞—Ç—å?';
            updateUI();
        });

        backFromCreateButton.addEventListener('click', () => {
            gameData.currentView = 'main';
            gameData.message = '–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ —Å–æ–±–∏—Ä–∞—Ç—å –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å!';
            updateUI();
        });


        // –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        updateUI();

        // –ü—Ä–∏–º–µ—Ä —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è (–º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å –¥–ª—è localStorage)
        // –≠—Ç–æ –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä. –î–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π –∏–≥—Ä—ã –Ω—É–∂–Ω–æ –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ.
        function saveGameData() {
            localStorage.setItem('coderGameData', JSON.stringify(gameData));
        }

        function loadGameData() {
            const savedData = localStorage.getItem('coderGameData');
            if (savedData) {
                gameData = JSON.parse(savedData);
            }
        }

        // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
        loadGameData();
        updateUI(); // –û–±–Ω–æ–≤–ª—è–µ–º UI –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö

        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥ (–ø—Ä–∏–º–µ—Ä)
        setInterval(saveGameData, 5000);

    </script>
</body>
</html>
