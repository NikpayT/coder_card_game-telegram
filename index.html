<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL Code Collector Game</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="game-container">
        <div class="header-info">
            <div class="header-left">
                <span id="experienceDisplay">üåü –û–ø—ã—Ç: 0</span>
                <span id="levelDisplay">‚¨ÜÔ∏è –£—Ä–æ–≤–µ–Ω—å: 1 (0/100 XP)</span>
                <div class="progress-bar-container">
                    <div id="levelProgressBar" class="progress-bar"></div>
                </div>
            </div>
            <div class="header-right">
                <span id="energyDisplay">‚ö°Ô∏è –≠–Ω–µ—Ä–≥–∏—è: 10/10</span>
            </div>
        </div>

        <p class="message" id="gameMessage">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∏–≥—Ä—É "–°–±–æ—Ä—â–∏–∫ SQL-—Ñ—É–Ω–∫—Ü–∏–π"! üöÄ</p>

        <div class="buttons-container" id="mainButtons">
            <button id="collectButton">–ù–∞–π—Ç–∏ SQL-—Ñ—É–Ω–∫—Ü–∏—é üîç (1 ‚ö°Ô∏è)</button>
            <button id="viewCollectionButton" class="secondary-button">–ú–æ—è –∫–æ–ª–ª–µ–∫—Ü–∏—è üéí</button>
            <button id="shopButton" class="secondary-button">–ú–∞–≥–∞–∑–∏–Ω üí∞</button>
            <button id="dailyBonusButton" class="secondary-button">–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å üéÅ</button>
            <button id="achievementsButton" class="secondary-button">–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è üèÜ</button>
            <button id="statsButton" class="secondary-button">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ üìà</button>
            <button id="projectBoardButton" class="secondary-button">–î–æ—Å–∫–∞ –ü—Ä–æ–µ–∫—Ç–æ–≤ üìã</button>
            <button id="boostersButton" class="secondary-button">–ë—É—Å—Ç–µ—Ä—ã üöÄ</button>
            <button id="marketButton" class="secondary-button">–†—ã–Ω–æ–∫ üíé</button>
            <button id="historyButton" class="secondary-button">–ò—Å—Ç–æ—Ä–∏—è üìú</button>
            <button id="createButton" class="secondary-button">–°–æ–∑–¥–∞—Ç—å –∑–∞–ø—Ä–æ—Å üõ†Ô∏è</button>
        </div>

        <div id="collectionDisplay" class="panel" style="display: none;">
            <h3 id="collectionHeader">–ú–æ—è –∫–æ–ª–ª–µ–∫—Ü–∏—è SQL: (0/55)</h3>
            <div id="collectionList" class="list-grid">
                <p>–ü–æ–∫–∞ –Ω–∏—á–µ–≥–æ –Ω–µ—Ç...</p>
            </div>
            <button id="backFromCollection" class="secondary-button" style="margin-top: 20px;">–ù–∞–∑–∞–¥</button>
        </div>

        <div id="createPanel" class="panel" style="display: none;">
            <h3>–°–æ–∑–¥–∞–Ω–∏–µ SQL-–∑–∞–ø—Ä–æ—Å–∞:</h3>
            <div id="availableParts">
                <p>–ó–¥–µ—Å—å –≤—ã —Å–º–æ–∂–µ—Ç–µ –æ–±—ä–µ–¥–∏–Ω—è—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤! (–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)</p>
            </div>
            <button id="backFromCreate" class="secondary-button" style="margin-top: 20px;">–ù–∞–∑–∞–¥</button>
        </div>

        <div id="shopPanel" class="panel" style="display: none;">
            <h3>–ú–∞–≥–∞–∑–∏–Ω SQL-—Ñ—É–Ω–∫—Ü–∏–π:</h3>
            <div id="buyableItemsList" class="list-grid">
                <p>–í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–æ–±—Ä–∞–Ω—ã!</p>
            </div>
            <button id="backFromShop" class="secondary-button" style="margin-top: 20px;">–ù–∞–∑–∞–¥</button>
        </div>

        <div id="marketPanel" class="panel" style="display: none;">
            <h3>–†—ã–Ω–æ–∫ –†–µ–¥–∫–∏—Ö –§—É–Ω–∫—Ü–∏–π:</h3>
            <p style="font-size: 0.9em; color: var(--light-text-color);">–ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ –∫—É–ø–∏—Ç—å —Ä–µ–¥–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å–ª–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –æ–±—ã—á–Ω—ã–º –ø–æ–∏—Å–∫–æ–º.</p>
            <div id="marketItemsList" class="list-grid">
                <p>–ù–∞ —Ä—ã–Ω–∫–µ –ø–æ–∫–∞ –Ω–µ—Ç —Ä–µ–¥–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π.</p>
            </div>
            <button id="backFromMarket" class="secondary-button" style="margin-top: 20px;">–ù–∞–∑–∞–¥</button>
        </div>

        <div id="dailyBonusPanel" class="panel" style="display: none;">
            <h3>–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å! üéÅ</h3>
            <p id="dailyBonusMessage" style="font-size: 1em; margin-bottom: 15px;">–ó–∞–±–µ—Ä–∏—Ç–µ —Å–≤–æ–π –±–æ–Ω—É—Å!</p>
            <button id="claimDailyBonusButton">–ó–∞–±—Ä–∞—Ç—å –±–æ–Ω—É—Å (5 üåü)</button>
            <button id="backFromDailyBonus" class="secondary-button" style="margin-top: 10px;">–ù–∞–∑–∞–¥</button>
        </div>

        <div id="achievementsPanel" class="panel" style="display: none;">
            <h3>–í–∞—à–∏ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è üèÜ</h3>
            <div id="achievementsList">
                </div>
            <button id="backFromAchievements" class="secondary-button" style="margin-top: 20px;">–ù–∞–∑–∞–¥</button>
        </div>

        <div id="statsPanel" class="panel" style="display: none;">
            <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ üìà</h3>
            <p>–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –Ω–∞–π–¥–µ–Ω–æ: <strong id="statsUniqueCount">0</strong></p>
            <p>–í—Å–µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–π (–≤–∫–ª—é—á–∞—è –¥—É–±–ª–∏–∫–∞—Ç—ã): <strong id="statsTotalCount">0</strong></p>
            <p>–û–ø—ã—Ç–∞ –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–æ: <strong id="statsExperienceEarned">0</strong></p>
            <p>–§—É–Ω–∫—Ü–∏–π –ø—Ä–æ–¥–∞–Ω–æ: <strong id="statsPartsSold">0</strong></p>
            <p>–§—É–Ω–∫—Ü–∏–π –∫—É–ø–ª–µ–Ω–æ: <strong id="statsPartsBought">0</strong></p>
            <button id="backFromStats" class="secondary-button" style="margin-top: 20px;">–ù–∞–∑–∞–¥</button>
        </div>

        <div id="projectPanel" class="panel" style="display: none;">
            <h3>–î–æ—Å–∫–∞ –ü—Ä–æ–µ–∫—Ç–æ–≤ üìã</h3>
            <p style="font-size: 0.9em; color: var(--light-text-color); margin-bottom: 20px;">–í—ã–ø–æ–ª–Ω—è–π—Ç–µ –ø—Ä–æ–µ–∫—Ç—ã, —Å–æ–±–∏—Ä–∞—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ SQL-—Ñ—É–Ω–∫—Ü–∏–∏, —á—Ç–æ–±—ã –∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å –±–æ–ª—å—à–∏–µ –Ω–∞–≥—Ä–∞–¥—ã!</p>
            <div id="projectList">
                <p>–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤.</p>
            </div>
            <button id="backFromProjectBoard" class="secondary-button" style="margin-top: 20px;">–ù–∞–∑–∞–¥</button>
        </div>

        <div id="boostersPanel" class="panel" style="display: none;">
            <h3>–ë—É—Å—Ç–µ—Ä—ã –∏ –£–ª—É—á—à–µ–Ω–∏—è üöÄ</h3>
            <p style="font-size: 0.9em; color: var(--light-text-color); margin-bottom: 20px;">–£–ª—É—á—à–∏—Ç–µ —Å–≤–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å! (–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±—É—Å—Ç–µ—Ä–æ–≤ 5 –º–∏–Ω—É—Ç)</p>
            <div id="boosterList">
                </div>
            <button id="backFromBoosters" class="secondary-button" style="margin-top: 20px;">–ù–∞–∑–∞–¥</button>
        </div>

        <div id="historyPanel" class="panel" style="display: none;">
            <h3>–ò—Å—Ç–æ—Ä–∏—è –î–µ–π—Å—Ç–≤–∏–π üìú</h3>
            <div id="historyLog">
                <p>–í–∞—à–∞ –∏—Å—Ç–æ—Ä–∏—è –¥–µ–π—Å—Ç–≤–∏–π –ø—É—Å—Ç–∞.</p>
            </div>
            <button id="backFromHistory" class="secondary-button" style="margin-top: 20px;">–ù–∞–∑–∞–¥</button>
        </div>


        <button id="resetGameButton" class="danger-button" style="margin-top: 30px;">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É –∑–∞–Ω–æ–≤–æ (—É–¥–∞–ª–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ) üí•</button>
    </div>

    <div id="partDetailModal" class="modal">
        <div class="modal-content">
            <span class="close-button" id="closePartDetailModal">&times;</span>
            <h4 id="modalPartName">–ù–∞–∑–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏</h4>
            <p><strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> <span id="modalPartDescription"></span></p>
            <p><strong>–¢–∏–ø:</strong> <span id="modalPartType"></span></p>
            <p><strong>–ü—Ä–∏–º–µ—Ä:</strong></p>
            <pre><code id="modalPartExample"></code></pre>
            <p><strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏:</strong> <span id="modalPartCount"></span></p>
            <div class="modal-buttons">
                 <button id="modalSellButton" class="item-action-button sell-button" style="display:none;">–ü—Ä–æ–¥–∞—Ç—å (1 üåü)</button>
            </div>
        </div>
    </div>

    <div class="version-info">
        –í–µ—Ä—Å–∏—è: <span id="gameVersion">0.6.2</span>
    </div>

    <script src="game_data.js"></script>

    <script>
        // --- –ò–≥—Ä–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ ---
        let gameData = {
            message: "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∏–≥—Ä—É!",
            collection: [], // [{id: 'sql_select', count: 1}]
            experience: 0,
            level: 1,
            xpToNextLevel: 100,
            currentXp: 0, // –û–ø—ã—Ç –Ω–∞ —Ç–µ–∫—É—â–µ–º —É—Ä–æ–≤–Ω–µ
            totalXpEarned: 0, // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–≥–æ –æ–ø—ã—Ç–∞ –∑–∞ –≤—Å–µ –≤—Ä–µ–º—è
            partsSold: 0,
            partsBought: 0,
            lastDailyBonusClaim: 0, // Timestamp –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –±–æ–Ω—É—Å–∞
            energy: 10,
            maxEnergy: 10,
            energyRecoveryRate: 1, // 1 —ç–Ω–µ—Ä–≥–∏—è –≤ 1 –º–∏–Ω—É—Ç—É
            lastEnergyRecovery: Date.now(),
            activeBoosters: [], // [{id: 'xp_boost', endsAt: timestamp, effect: {type: 'xp_multiplier', value: 2}}]
            history: [], // [{timestamp: Date.now(), message: "–ù–∞–π–¥–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è X"}]
            achievements: { // –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
                collect_5_unique: { completed: false, reward: 10, name: '–ü–µ—Ä–≤–æ–æ—Ç–∫—Ä—ã–≤–∞—Ç–µ–ª—å', description: '–°–æ–±—Ä–∞—Ç—å 5 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö SQL-—Ñ—É–Ω–∫—Ü–∏–π' },
                collect_10_unique: { completed: false, reward: 20, name: '–Æ–Ω—ã–π –ë–∞–∑–∏—Å—Ç', description: '–°–æ–±—Ä–∞—Ç—å 10 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö SQL-—Ñ—É–Ω–∫—Ü–∏–π' },
                collect_20_unique: { completed: false, reward: 40, name: '–ú–∞—Å—Ç–µ—Ä –ó–∞–ø—Ä–æ—Å–æ–≤', description: '–°–æ–±—Ä–∞—Ç—å 20 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö SQL-—Ñ—É–Ω–∫—Ü–∏–π' },
                collect_all_unique: { completed: false, reward: 100, name: '–í–µ–ª–∏–∫–∏–π –°–±–æ—Ä—â–∏–∫', description: '–°–æ–±—Ä–∞—Ç—å –≤—Å–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ SQL-—Ñ—É–Ω–∫—Ü–∏–∏' },
                earn_50_xp: { completed: false, reward: 15, name: '–û–ø—ã—Ç–Ω—ã–π –ö–æ–¥–µ—Ä', description: '–ó–∞—Ä–∞–±–æ—Ç–∞—Ç—å 50 –æ–ø—ã—Ç–∞' },
                earn_200_xp: { completed: false, reward: 50, name: '–ì—É—Ä—É SQL', description: '–ó–∞—Ä–∞–±–æ—Ç–∞—Ç—å 200 –æ–ø—ã—Ç–∞' },
                sell_5_parts: { completed: false, reward: 10, name: '–¢–æ—Ä–≥–æ–≤–µ—Ü –î–∞–Ω–Ω—ã–º–∏', description: '–ü—Ä–æ–¥–∞—Ç—å 5 SQL-—Ñ—É–Ω–∫—Ü–∏–π' },
                buy_5_parts: { completed: false, reward: 10, name: '–û–ø—ã—Ç–Ω—ã–π –ü–æ–∫—É–ø–∞—Ç–µ–ª—å', description: '–ö—É–ø–∏—Ç—å 5 SQL-—Ñ—É–Ω–∫—Ü–∏–π' },
                complete_1_project: { completed: false, reward: 25, name: '–ü–µ—Ä–≤—ã–π –ü—Ä–æ–µ–∫—Ç', description: '–ó–∞–≤–µ—Ä—à–∏—Ç—å 1 –ø—Ä–æ–µ–∫—Ç' },
                complete_3_projects: { completed: false, reward: 50, name: '–ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä –ë–∞–∑ –î–∞–Ω–Ω—ã—Ö', description: '–ó–∞–≤–µ—Ä—à–∏—Ç—å 3 –ø—Ä–æ–µ–∫—Ç–∞' },
            },
            projects: [ // –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã
                { id: 'proj_basic_select', name: '–ë–∞–∑–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö', description: '–ò–∑–≤–ª–µ—á—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã Customers.', requirements: ['sql_select', 'sql_from'], completed: false, reward_xp: 20 },
                { id: 'proj_filtered_select', name: '–í—ã–±–æ—Ä–∫–∞ —Å —Ñ–∏–ª—å—Ç—Ä–æ–º', description: '–ù–∞–π—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç—ã –¥–æ—Ä–æ–∂–µ 50.', requirements: ['sql_select', 'sql_from', 'sql_where'], completed: false, reward_xp: 35 },
                { id: 'proj_insert_data', name: '–í—Å—Ç–∞–≤–∫–∞ –Ω–æ–≤–æ–π –∑–∞–ø–∏—Å–∏', description: '–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ç–∞–±–ª–∏—Ü—É.', requirements: ['sql_insert_into', 'sql_values'], completed: false, reward_xp: 25 },
                { id: 'proj_update_record', name: '–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏', description: '–ò–∑–º–µ–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∑–∞–ø–∏—Å–∏.', requirements: ['sql_update', 'sql_set', 'sql_where'], completed: false, reward_xp: 30 },
                { id: 'proj_delete_record', name: '–£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏', description: '–£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å –∏–∑ —Ç–∞–±–ª–∏—Ü—ã.', requirements: ['sql_delete_from', 'sql_where'], completed: false, reward_xp: 20 },
                { id: 'proj_table_join', name: '–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü', description: '–°–æ–µ–¥–∏–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ Customers –∏ Orders.', requirements: ['sql_select', 'sql_from', 'sql_join'], completed: false, reward_xp: 50 },
                { id: 'proj_create_simple_table', name: '–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–π —Ç–∞–±–ª–∏—Ü—ã', description: '–°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É —Å ID –∏ –∏–º–µ–Ω–µ–º.', requirements: ['sql_create_table', 'sql_int', 'sql_varchar'], completed: false, reward_xp: 40 },
                { id: 'proj_count_records', name: '–ü–æ–¥—Å—á–µ—Ç –∑–∞–ø–∏—Å–µ–π', description: '–ü–æ—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –≤ —Ç–∞–±–ª–∏—Ü–µ.', requirements: ['sql_select', 'sql_count', 'sql_from'], completed: false, reward_xp: 20 },
                { id: 'proj_aggregate_data', name: '–ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö', description: '–í—ã—á–∏—Å–ª–∏—Ç—å —Å—Ä–µ–¥–Ω—é—é —Ü–µ–Ω—É –ø—Ä–æ–¥—É–∫—Ç–æ–≤, —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.', requirements: ['sql_select', 'sql_avg', 'sql_group_by'], completed: false, reward_xp: 45 }
            ],
            currentView: 'main' // 'main', 'collection', 'create', 'shop', 'daily_bonus', 'achievements', 'stats', 'market', 'boosters', 'projects', 'history'
        };

        // --- –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏–≥—Ä—ã ---
        const PART_PRICE = 1; // –°—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ–∫—É–ø–∫–∏/–ø—Ä–æ–¥–∞–∂–∏ –æ–¥–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
        const XP_PER_LEVEL_BASE = 100;
        const XP_PER_LEVEL_MULTIPLIER = 1.2;
        const DAILY_BONUS_AMOUNT = 5;
        const DAILY_BONUS_COOLDOWN_MS = 24 * 60 * 60 * 1000; // 24 —á–∞—Å–∞
        const ENERGY_CONSUMPTION_PER_FIND = 1;
        const ENERGY_RECOVERY_INTERVAL_MS = 60 * 1000; // 1 –º–∏–Ω—É—Ç–∞

        // –¢–∏–ø—ã —Ä–µ–¥–∫–æ—Å—Ç–∏ (–¥–ª—è —Ä—ã–Ω–∫–∞ –∏ –±—É—Å—Ç–µ—Ä–æ–≤)
        const RARITIES = {
            common: { chance: 0.5, price: 1, name: '–û–±—ã—á–Ω–∞—è' },
            uncommon: { chance: 0.3, price: 3, name: '–ù–µ–æ–±—ã—á–Ω–∞—è' },
            rare: { chance: 0.15, price: 5, name: '–†–µ–¥–∫–∞—è' },
            epic: { chance: 0.04, price: 10, name: '–≠–ø–∏—á–µ—Å–∫–∞—è' },
            legendary: { chance: 0.01, price: 20, name: '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è' }
        };

        // –ë—É—Å—Ç–µ—Ä—ã
        const BOOSTERS = [
            { id: 'xp_boost', name: '–ë—É—Å—Ç–µ—Ä –æ–ø—ã—Ç–∞ (x2)', description: '–£–¥–≤–æ–µ–Ω–Ω—ã–π –æ–ø—ã—Ç –∑–∞ –Ω–∞—Ö–æ–¥–∫–∏ –Ω–∞ 5 –º–∏–Ω—É—Ç.', cost: 5, duration: 5 * 60 * 1000, effect: { type: 'xp_multiplier', value: 2 } },
            { id: 'energy_boost', name: '–ë—É—Å—Ç–µ—Ä —ç–Ω–µ—Ä–≥–∏–∏', description: '–ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ 5 —ç–Ω–µ—Ä–≥–∏–∏.', cost: 3, effect: { type: 'energy_refill', value: 5 } },
            { id: 'find_chance_boost', name: '–ë—É—Å—Ç–µ—Ä —É–¥–∞—á–∏ (+10% —Ä–µ–¥–∫–∏—Ö)', description: '–ü–æ–≤—ã—à–∞–µ—Ç —à–∞–Ω—Å –Ω–∞–π—Ç–∏ —Ä–µ–¥–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ 10% –Ω–∞ 5 –º–∏–Ω—É—Ç.', cost: 7, duration: 5 * 60 * 1000, effect: { type: 'rare_chance', value: 0.1 } }
        ];


        // --- DOM-—ç–ª–µ–º–µ–Ω—Ç—ã (–∫–µ—à–∏—Ä—É–µ–º –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏) ---
        const gameMessageElement = document.getElementById('gameMessage');
        const experienceDisplay = document.getElementById('experienceDisplay');
        const levelDisplay = document.getElementById('levelDisplay');
        const levelProgressBar = document.getElementById('levelProgressBar');
        const energyDisplay = document.getElementById('energyDisplay');
        const mainButtonsContainer = document.getElementById('mainButtons');

        // –ö–Ω–æ–ø–∫–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –º–µ–Ω—é
        const collectButton = document.getElementById('collectButton');
        const viewCollectionButton = document.getElementById('viewCollectionButton');
        const createButton = document.getElementById('createButton');
        const shopButton = document.getElementById('shopButton');
        const dailyBonusButton = document.getElementById('dailyBonusButton');
        const achievementsButton = document.getElementById('achievementsButton');
        const statsButton = document.getElementById('statsButton');
        const projectBoardButton = document.getElementById('projectBoardButton');
        const boostersButton = document.getElementById('boostersButton');
        const marketButton = document.getElementById('marketButton');
        const historyButton = document.getElementById('historyButton');

        // –ü–∞–Ω–µ–ª–∏
        const collectionDisplay = document.getElementById('collectionDisplay');
        const collectionHeader = document.getElementById('collectionHeader');
        const collectionList = document.getElementById('collectionList');
        const backFromCollectionButton = document.getElementById('backFromCollection');

        const createPanel = document.getElementById('createPanel');
        const backFromCreateButton = document.getElementById('backFromCreate');

        const shopPanel = document.getElementById('shopPanel');
        const buyableItemsList = document.getElementById('buyableItemsList');
        const backFromShopButton = document.getElementById('backFromShop');

        const marketPanel = document.getElementById('marketPanel');
        const marketItemsList = document.getElementById('marketItemsList');
        const backFromMarketButton = document.getElementById('backFromMarket');

        const dailyBonusPanel = document.getElementById('dailyBonusPanel');
        const dailyBonusMessage = document.getElementById('dailyBonusMessage');
        const claimDailyBonusButton = document.getElementById('claimDailyBonusButton');
        const backFromDailyBonusButton = document.getElementById('backFromDailyBonus');

        const achievementsPanel = document.getElementById('achievementsPanel');
        const achievementsList = document.getElementById('achievementsList');
        const backFromAchievementsButton = document.getElementById('backFromAchievements');

        const statsPanel = document.getElementById('statsPanel');
        const statsUniqueCount = document.getElementById('statsUniqueCount');
        const statsTotalCount = document.getElementById('statsTotalCount');
        const statsExperienceEarned = document.getElementById('statsExperienceEarned');
        const statsPartsSold = document.getElementById('statsPartsSold');
        const statsPartsBought = document.getElementById('statsPartsBought');
        const backFromStatsButton = document.getElementById('backFromStats');

        const projectPanel = document.getElementById('projectPanel');
        const projectList = document.getElementById('projectList');
        const backFromProjectBoardButton = document.getElementById('backFromProjectBoard');

        const boostersPanel = document.getElementById('boostersPanel');
        const boosterList = document.getElementById('boosterList');
        const backFromBoostersButton = document.getElementById('backFromBoosters');

        const historyPanel = document.getElementById('historyPanel');
        const historyLog = document.getElementById('historyLog');
        const backFromHistoryButton = document.getElementById('backFromHistory');

        const resetGameButton = document.getElementById('resetGameButton');

        // Modal elements
        const partDetailModal = document.getElementById('partDetailModal');
        const closePartDetailModal = document.getElementById('closePartDetailModal');
        const modalPartName = document.getElementById('modalPartName');
        const modalPartDescription = document.getElementById('modalPartDescription');
        const modalPartType = document.getElementById('modalPartType');
        const modalPartExample = document.getElementById('modalPartExample');
        const modalPartCount = document.getElementById('modalPartCount');
        const modalSellButton = document.getElementById('modalSellButton');


        // --- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App SDK ---
        if (window.Telegram && window.Telegram.WebApp) {
            Telegram.WebApp.ready();
            Telegram.WebApp.expand();
            console.log('Telegram WebApp initialized.');
        } else {
            console.warn('Telegram WebApp script not loaded or not in Telegram environment. Running in standalone mode.');
        }

        // --- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ UI –∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏ ---
        function updateUI() {
            // –û–±—â–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º textContent –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –∏ –¥–æ–±–∞–≤–ª—è–µ–º —ç–º–æ–¥–∑–∏ –æ—Ç–¥–µ–ª—å–Ω–æ
            gameMessageElement.textContent = gameData.message;
            experienceDisplay.textContent = `üåü –û–ø—ã—Ç: ${gameData.experience}`;
            levelDisplay.textContent = `‚¨ÜÔ∏è –£—Ä–æ–≤–µ–Ω—å: ${gameData.level} (${gameData.currentXp}/${gameData.xpToNextLevel} XP)`;
            const progressPercentage = (gameData.currentXp / gameData.xpToNextLevel) * 100;
            levelProgressBar.style.width = `${progressPercentage}%`;

            // –≠–Ω–µ—Ä–≥–∏—è
            updateEnergy(); // –û–±–Ω–æ–≤–ª—è–µ–º —ç–Ω–µ—Ä–≥–∏—é –ø–µ—Ä–µ–¥ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º
            energyDisplay.textContent = `‚ö°Ô∏è –≠–Ω–µ—Ä–≥–∏—è: ${gameData.energy}/${gameData.maxEnergy}`;

            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –ø–∞–Ω–µ–ª–∏
            const allPanels = [
                mainButtonsContainer, collectionDisplay, createPanel, shopPanel,
                dailyBonusPanel, achievementsPanel, statsPanel, projectPanel,
                boostersPanel, historyPanel, marketPanel
            ];
            allPanels.forEach(panel => panel.style.display = 'none');
            resetGameButton.style.display = 'block'; // –ö–Ω–æ–ø–∫–∞ —Å–±—Ä–æ—Å–∞ –≤—Å–µ–≥–¥–∞ –≤–∏–¥–Ω–∞

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é –ø–∞–Ω–µ–ª—å –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ –≤–∏–¥–∞
            switch (gameDat
